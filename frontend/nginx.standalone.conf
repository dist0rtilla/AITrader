server {
  listen 80;
  server_name _;

  root /usr/share/nginx/html;
  index index.html;

  # Main SPA route - serve index.html for all routes
  location / {
    try_files $uri $uri/ /index.html;
  }

  # Serve built assets referenced under /ui/ (some builds reference /ui/* paths)
  location /ui/ {
    alias /usr/share/nginx/html/;
    try_files $uri $uri/ /ui/index.html;
  }

  # Mock API endpoints for testing
  location = /api/status {
    add_header Content-Type application/json;
    return 200 '{"status": "ok", "message": "Frontend running standalone"}';
  }

  # Mock WebSocket endpoint (will fail gracefully in frontend)
  location = /api/ws/monitor {
    return 502 '{"error": "WebSocket not available in standalone mode"}';
  }

  # Mock other API requests
  location /api/ {
    add_header Content-Type application/json;
    return 200 '{"error": "API not available in standalone mode", "standalone": true}';
  }

  # Enable gzip compression
  gzip on;
  gzip_vary on;
  gzip_min_length 1024;
  gzip_types text/plain text/css text/xml text/javascript application/javascript application/xml+rss application/json;
}